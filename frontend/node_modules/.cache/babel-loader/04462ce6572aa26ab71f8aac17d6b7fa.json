{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar util_1 = require(\"../util\");\n\nvar bk_1 = require(\"./bk\");\n\nvar positionY = function positionY(g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var rankSep = g.graph().ranksep;\n  var prevY = 0;\n  layering === null || layering === void 0 ? void 0 : layering.forEach(function (layer) {\n    var heights = layer.map(function (v) {\n      return g.node(v).height;\n    });\n    var maxHeight = Math.max.apply(Math, heights);\n    layer === null || layer === void 0 ? void 0 : layer.forEach(function (v) {\n      g.node(v).y = prevY + maxHeight / 2;\n    });\n    prevY += maxHeight + rankSep;\n  });\n};\n\nvar positionX = function positionX(g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var conflicts = Object.assign((0, bk_1.findType1Conflicts)(g, layering), (0, bk_1.findType2Conflicts)(g, layering));\n  var xss = {};\n  var adjustedLayering = [];\n  [\"u\", \"d\"].forEach(function (vert) {\n    adjustedLayering = vert === \"u\" ? layering : Object.values(layering).reverse();\n    [\"l\", \"r\"].forEach(function (horiz) {\n      if (horiz === \"r\") {\n        adjustedLayering = adjustedLayering.map(function (inner) {\n          return Object.values(inner).reverse();\n        });\n      }\n\n      var neighborFn = (vert === \"u\" ? g.predecessors : g.successors).bind(g);\n      var align = (0, bk_1.verticalAlignment)(g, adjustedLayering, conflicts, neighborFn);\n      var xs = (0, bk_1.horizontalCompaction)(g, adjustedLayering, align.root, align.align, horiz === \"r\");\n\n      if (horiz === \"r\") {\n        Object.keys(xs).forEach(function (xsKey) {\n          return xs[xsKey] = -xs[xsKey];\n        });\n      }\n\n      xss[vert + horiz] = xs;\n    });\n  });\n  var smallestWidth = (0, bk_1.findSmallestWidthAlignment)(g, xss);\n  smallestWidth && (0, bk_1.alignCoordinates)(xss, smallestWidth);\n  return (0, bk_1.balance)(xss, g.graph().align);\n};\n\nvar position = function position(g) {\n  var _a;\n\n  var ng = (0, util_1.asNonCompoundGraph)(g);\n  positionY(ng);\n  var xs = positionX(ng);\n  (_a = Object.keys(xs)) === null || _a === void 0 ? void 0 : _a.forEach(function (key) {\n    ng.node(key).x = xs[key];\n  });\n};\n\nexports.default = position;","map":null,"metadata":{},"sourceType":"script"}