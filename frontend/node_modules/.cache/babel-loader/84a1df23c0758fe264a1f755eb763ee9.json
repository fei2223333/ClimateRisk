{"ast":null,"code":"import { Ellipse } from '../../geometry';\nimport { toResult } from './util';\nexport var ellipse = function ellipse(portsPositionArgs, elemBBox, groupPositionArgs) {\n  var startAngle = groupPositionArgs.start || 0;\n  var stepAngle = groupPositionArgs.step || 20;\n  return ellipseLayout(portsPositionArgs, elemBBox, startAngle, function (index, count) {\n    return (index + 0.5 - count / 2) * stepAngle;\n  });\n};\nexport var ellipseSpread = function ellipseSpread(portsPositionArgs, elemBBox, groupPositionArgs) {\n  var startAngle = groupPositionArgs.start || 0;\n  var stepAngle = groupPositionArgs.step || 360 / portsPositionArgs.length;\n  return ellipseLayout(portsPositionArgs, elemBBox, startAngle, function (index) {\n    return index * stepAngle;\n  });\n};\n\nfunction ellipseLayout(portsPositionArgs, elemBBox, startAngle, stepFn) {\n  var center = elemBBox.getCenter();\n  var start = elemBBox.getTopCenter();\n  var ratio = elemBBox.width / elemBBox.height;\n  var ellipse = Ellipse.fromRect(elemBBox);\n  var count = portsPositionArgs.length;\n  return portsPositionArgs.map(function (item, index) {\n    var angle = startAngle + stepFn(index, count);\n    var p = start.clone().rotate(-angle, center).scale(ratio, 1, center);\n    var theta = item.compensateRotate ? -ellipse.tangentTheta(p) : 0;\n\n    if (item.dx || item.dy) {\n      p.translate(item.dx || 0, item.dy || 0);\n    }\n\n    if (item.dr) {\n      p.move(center, item.dr);\n    }\n\n    return toResult(p.round(), theta, item);\n  });\n}","map":null,"metadata":{},"sourceType":"module"}