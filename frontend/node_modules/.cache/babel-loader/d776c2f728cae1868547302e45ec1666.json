{"ast":null,"code":"import _classCallCheck from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _get from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/shuge/Documents/project/rekit-project/diagpanel2/ServiceWebsite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { View } from '../../view';\nexport var Widget = /*#__PURE__*/function (_View) {\n  _inherits(Widget, _View);\n\n  function Widget(options) {\n    var _this;\n\n    _classCallCheck(this, Widget);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Widget).call(this));\n\n    var _a = options,\n        view = _a.view,\n        cell = _a.cell,\n        node = _a.node,\n        edge = _a.edge,\n        graph = _a.graph,\n        localOptions = __rest(_a, [\"view\", \"cell\", \"node\", \"edge\", \"graph\"]);\n\n    if (view) {\n      _this.view = view;\n      _this.cell = view.cell;\n      _this.graph = view.graph;\n      _this.model = _this.graph.model;\n    } else if ((cell || edge || node) && graph) {\n      _this.cell = node || edge || cell;\n      _this.view = graph.renderer.findViewByCell(_this.cell);\n      _this.graph = graph;\n      _this.model = _this.graph.model;\n    }\n\n    var ctor = _this.constructor;\n\n    if (options.clearAll !== false) {\n      ctor.removeInstances(_this.graph);\n    }\n\n    ctor.register(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this.init(localOptions);\n\n    return _this;\n  }\n\n  _createClass(Widget, [{\n    key: \"init\",\n    value: function init(options) {} // eslint-disable-line\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this;\n    }\n  }, {\n    key: \"startListening\",\n    value: function startListening() {\n      if (this.options.clearOnBlankMouseDown !== false) {\n        this.graph.on('blank:mousedown', this.remove, this);\n      }\n    }\n  }, {\n    key: \"stopListening\",\n    value: function stopListening() {\n      if (this.options.clearOnBlankMouseDown !== false) {\n        this.graph.off('blank:mousedown', this.remove, this);\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      this.stopListening();\n      var ctor = this.constructor;\n      ctor.unregister(this);\n      return _get(_getPrototypeOf(Widget.prototype), \"remove\", this).call(this);\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.remove();\n    }\n  }], [{\n    key: \"ensureCache\",\n    value: function ensureCache() {\n      if (!this.instanceCache.has(this)) {\n        this.instanceCache.set(this, {});\n      }\n\n      return this.instanceCache.get(this);\n    }\n  }, {\n    key: \"register\",\n    value: function register(instance, graph) {\n      if (graph == null) {\n        // eslint-disable-next-line\n        graph = instance.graph;\n      }\n\n      var dic = this.ensureCache();\n      var cache = dic[graph.view.cid];\n\n      if (cache == null) {\n        cache = dic[graph.view.cid] = {};\n      }\n\n      cache[instance.cid] = instance;\n    }\n  }, {\n    key: \"unregister\",\n    value: function unregister(instance, graph) {\n      if (graph == null) {\n        // eslint-disable-next-line\n        graph = instance.graph;\n      }\n\n      var dic = this.ensureCache();\n\n      if (dic[graph.view.cid]) {\n        delete dic[graph.view.cid][instance.cid];\n      }\n    }\n  }, {\n    key: \"removeInstances\",\n    value: function removeInstances(graph) {\n      var dic = this.ensureCache();\n      var cache = dic[graph.view.cid];\n\n      if (cache) {\n        Object.keys(cache).forEach(function (cid) {\n          var instance = cache[cid];\n\n          if (instance) {\n            instance.remove();\n          }\n        });\n      }\n    }\n  }, {\n    key: \"getInstances\",\n    value: function getInstances(graph) {\n      var dic = this.ensureCache();\n      return dic[graph.view.cid] || {};\n    }\n  }]);\n\n  return Widget;\n}(View); // #region static\n\nWidget.instanceCache = new WeakMap();\n\n__decorate([View.dispose()], Widget.prototype, \"dispose\", null);","map":null,"metadata":{},"sourceType":"module"}