{"ast":null,"code":"import _toConsumableArray from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _construct from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/construct\";\nimport _slicedToArray from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _wrapNativeSuper from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport toposort from 'toposort';\nexport var ErrorUtils;\n\n(function (ErrorUtils) {\n  var ErrorEnum;\n\n  (function (ErrorEnum) {\n    ErrorEnum[\"INVALID_HOOK_BEFORE\"] = \"INVALID_HOOK_BEFORE\";\n    ErrorEnum[\"INVALID_HOOK_AFTER\"] = \"INVALID_HOOK_AFTER\";\n    ErrorEnum[\"INVALID_HOOK_ARGS_LENGTH\"] = \"INVALID_HOOK_ARGS_LENGTH\";\n  })(ErrorEnum = ErrorUtils.ErrorEnum || (ErrorUtils.ErrorEnum = {}));\n\n  var HookError = /*#__PURE__*/function (_Error) {\n    _inherits(HookError, _Error);\n\n    function HookError(code, message) {\n      var _this;\n\n      _classCallCheck(this, HookError);\n\n      if (Array.isArray(message)) {\n        message = message.filter(function (line) {\n          return !!line;\n        }).join(' ');\n      }\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(HookError).call(this, \"\".concat(code, \": \").concat(message)));\n\n      if (Error.captureStackTrace) {\n        ;\n        Error.captureStackTrace(_assertThisInitialized(_assertThisInitialized(_this)), HookError);\n      }\n\n      _this.code = code;\n      _this.contexts = {};\n\n      for (var _len = arguments.length, contexts = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        contexts[_key - 2] = arguments[_key];\n      }\n\n      contexts.forEach(function (context) {\n        if (typeof context === 'object') {\n          Object.entries(context).forEach(function (pair) {\n            var _pair = _slicedToArray(pair, 2),\n                key = _pair[0],\n                value = _pair[1];\n\n            if (key !== 'key' && value) {\n              _this.contexts[key] = JSON.parse(JSON.stringify(value));\n            }\n          });\n        }\n      });\n      return _this;\n    }\n\n    _createClass(HookError, [{\n      key: \"toString\",\n      value: function toString() {\n        return \"\".concat(this.code, \": \").concat(this.message);\n      }\n    }]);\n\n    return HookError;\n  }(_wrapNativeSuper(Error));\n\n  ErrorUtils.HookError = HookError;\n\n  var createError = function createError(code, message) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n      args[_key2 - 2] = arguments[_key2];\n    }\n\n    return _construct(HookError, [code, message].concat(args));\n  };\n\n  ErrorUtils.HookBeforeError = function () {\n    return createError(ErrorEnum.INVALID_HOOK_BEFORE, ['hook require a before dependency but not exist in hookmap']);\n  };\n\n  ErrorUtils.HookAfterError = function () {\n    return createError(ErrorEnum.INVALID_HOOK_AFTER, ['hook require a after dependency but not exist in hookmap']);\n  };\n\n  ErrorUtils.InvalidHookArguments = function (hook) {\n    return createError(ErrorEnum.INVALID_HOOK_ARGS_LENGTH, ['hook handlers must have 0 to 2 arguments', \"but got \".concat(hook.handler.length)]);\n  };\n})(ErrorUtils || (ErrorUtils = {}));\n\nexport var HookUtils;\n\n(function (HookUtils) {\n  /** 处理 runtime hooks */\n  HookUtils.normalize = function () {\n    var hookConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var hookMap = arguments.length > 1 ? arguments[1] : undefined;\n    var runtimeHook = Array.isArray(hookConfig) ? hookConfig : [hookConfig];\n    var innerHooks = [];\n    hookMap.forEach(function (val) {\n      innerHooks.push(val);\n    });\n    return [].concat(innerHooks, _toConsumableArray(runtimeHook)).filter(function (item) {\n      return item && !!item.handler;\n    });\n  };\n  /** 排序 hooks */\n\n\n  HookUtils.sort = function () {\n    var hooks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var hookMap = arguments.length > 1 ? arguments[1] : undefined;\n    var edges = [];\n    hooks.forEach(function (hook) {\n      if (hook.before) {\n        if (!hookMap.has(hook.before)) {\n          throw ErrorUtils.HookBeforeError();\n        }\n\n        var edge = [hook, hookMap.get(hook.before)];\n        edges.push(edge);\n      }\n\n      if (hook.after) {\n        if (!hookMap.has(hook.after)) {\n          throw ErrorUtils.HookBeforeError();\n        }\n\n        var _edge = [hookMap.get(hook.after), hook];\n        edges.push(_edge);\n      }\n    });\n    var sortedHooks = toposort.array(hooks, edges);\n    return sortedHooks;\n  };\n})(HookUtils || (HookUtils = {}));\n\nexport var Deferred = function Deferred() {\n  var _this2 = this;\n\n  _classCallCheck(this, Deferred);\n\n  this.isResolved = false;\n  this.isRejected = false;\n  this.promise = new Promise(function (resolve, reject) {\n    _this2.resolve = function (args) {\n      _this2.isResolved = true;\n      resolve(args);\n    };\n\n    _this2.reject = function (args) {\n      _this2.isRejected = true;\n      reject(args);\n    };\n  });\n};","map":null,"metadata":{},"sourceType":"module"}