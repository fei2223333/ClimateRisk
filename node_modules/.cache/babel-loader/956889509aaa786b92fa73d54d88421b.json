{"ast":null,"code":"import { NumberExt } from '../../util';\nimport { Base } from '../base';\nvar CYLINDER_TILT = 10;\nexport var Cylinder = Base.define({\n  shape: 'cylinder',\n  overwrite: true,\n  markup: [{\n    tagName: 'path',\n    selector: 'body'\n  }, {\n    tagName: 'ellipse',\n    selector: 'top'\n  }, {\n    tagName: 'text',\n    selector: 'label'\n  }],\n  attrs: {\n    body: Object.assign(Object.assign({}, Base.bodyAttr), {\n      lateral: CYLINDER_TILT\n    }),\n    top: Object.assign(Object.assign({}, Base.bodyAttr), {\n      refCx: '50%',\n      refRx: '50%',\n      cy: CYLINDER_TILT,\n      ry: CYLINDER_TILT\n    })\n  },\n  attrHooks: {\n    lateral: {\n      set: function set(t, _ref) {\n        var refBBox = _ref.refBBox;\n        var isPercentage = NumberExt.isPercentage(t);\n\n        if (isPercentage) {\n          // eslint-disable-next-line\n          t = parseFloat(t) / 100;\n        }\n\n        var x = refBBox.x;\n        var y = refBBox.y;\n        var w = refBBox.width;\n        var h = refBBox.height; // curve control point variables\n\n        var rx = w / 2;\n        var ry = isPercentage ? h * t : t;\n        var kappa = 0.551784;\n        var cx = kappa * rx;\n        var cy = kappa * ry; // shape variables\n\n        var xLeft = x;\n        var xCenter = x + w / 2;\n        var xRight = x + w;\n        var ySideTop = y + ry;\n        var yCurveTop = ySideTop - ry;\n        var ySideBottom = y + h - ry;\n        var yCurveBottom = y + h; // return calculated shape\n\n        var data = ['M', xLeft, ySideTop, 'L', xLeft, ySideBottom, 'C', x, ySideBottom + cy, xCenter - cx, yCurveBottom, xCenter, yCurveBottom, 'C', xCenter + cx, yCurveBottom, xRight, ySideBottom + cy, xRight, ySideBottom, 'L', xRight, ySideTop, 'C', xRight, ySideTop - cy, xCenter + cx, yCurveTop, xCenter, yCurveTop, 'C', xCenter - cx, yCurveTop, xLeft, ySideTop - cy, xLeft, ySideTop, 'Z'];\n        return {\n          d: data.join(' ')\n        };\n      }\n    }\n  },\n  knob: {\n    enabled: true,\n    position: function position(_ref2) {\n      var node = _ref2.node;\n      var lateral = node.attr('body/lateral');\n      return {\n        x: 0,\n        y: lateral\n      };\n    },\n    onMouseMove: function onMouseMove(_ref3) {\n      var node = _ref3.node,\n          data = _ref3.data,\n          deltaY = _ref3.deltaY;\n\n      if (deltaY !== 0) {\n        var bbox = node.getBBox();\n        var previous = node.attr('body/lateral');\n\n        if (data.round == null) {\n          data.round = previous;\n        }\n\n        var min = 0;\n        var max = bbox.height / 2;\n        var current = NumberExt.clamp(data.round + deltaY, min, max);\n\n        if (current !== previous) {\n          node.attr({\n            body: {\n              lateral: current\n            },\n            top: {\n              cy: current,\n              ry: current\n            }\n          });\n        }\n      }\n    }\n  }\n});","map":null,"metadata":{},"sourceType":"module"}