{"ast":null,"code":"import _classCallCheck from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { StringExt, Dom, Vector } from '../util';\nimport { Filter } from '../registry';\nimport { Markup } from '../view';\nimport { Base } from './base';\nexport var DefsManager = /*#__PURE__*/function (_Base) {\n  _inherits(DefsManager, _Base);\n\n  function DefsManager() {\n    _classCallCheck(this, DefsManager);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DefsManager).apply(this, arguments));\n  }\n\n  _createClass(DefsManager, [{\n    key: \"isDefined\",\n    value: function isDefined(id) {\n      return this.svg.getElementById(id) != null;\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(options) {\n      var filterId = options.id;\n      var name = options.name;\n\n      if (!filterId) {\n        filterId = \"filter-\".concat(name, \"-\").concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(filterId)) {\n        var fn = Filter.registry.get(name);\n\n        if (fn == null) {\n          return Filter.registry.onNotFound(name);\n        }\n\n        var markup = fn(options.args || {}); // Set the filter area to be 3x the bounding box of the cell\n        // and center the filter around the cell.\n\n        var attrs = Object.assign(Object.assign({\n          x: -1,\n          y: -1,\n          width: 3,\n          height: 3,\n          filterUnits: 'objectBoundingBox'\n        }, options.attrs), {\n          id: filterId\n        });\n        Vector.create(Markup.sanitize(markup), attrs).appendTo(this.defs);\n      }\n\n      return filterId;\n    }\n  }, {\n    key: \"gradient\",\n    value: function gradient(options) {\n      var id = options.id;\n      var type = options.type;\n\n      if (!id) {\n        id = \"gradient-\".concat(type, \"-\").concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(id)) {\n        var stops = options.stops;\n        var arr = stops.map(function (stop) {\n          var opacity = stop.opacity != null && Number.isFinite(stop.opacity) ? stop.opacity : 1;\n          return \"<stop offset=\\\"\".concat(stop.offset, \"\\\" stop-color=\\\"\").concat(stop.color, \"\\\" stop-opacity=\\\"\").concat(opacity, \"\\\"/>\");\n        });\n        var markup = \"<\".concat(type, \">\").concat(arr.join(''), \"</\").concat(type, \">\");\n        var attrs = Object.assign({\n          id: id\n        }, options.attrs);\n        Vector.create(markup, attrs).appendTo(this.defs);\n      }\n\n      return id;\n    }\n  }, {\n    key: \"marker\",\n    value: function marker(options) {\n      var id = options.id,\n          refX = options.refX,\n          refY = options.refY,\n          markerUnits = options.markerUnits,\n          markerOrient = options.markerOrient,\n          tagName = options.tagName,\n          children = options.children,\n          attrs = __rest(options, [\"id\", \"refX\", \"refY\", \"markerUnits\", \"markerOrient\", \"tagName\", \"children\"]);\n\n      var markerId = id;\n\n      if (!markerId) {\n        markerId = \"marker-\".concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(markerId)) {\n        if (tagName !== 'path') {\n          // remove unnecessary d attribute inherit from standard edge.\n          delete attrs.d;\n        }\n\n        var pathMarker = Vector.create('marker', {\n          refX: refX,\n          refY: refY,\n          id: markerId,\n          overflow: 'visible',\n          orient: markerOrient != null ? markerOrient : 'auto',\n          markerUnits: markerUnits || 'userSpaceOnUse'\n        }, children ? children.map(function (_a) {\n          var tagName = _a.tagName,\n              other = __rest(_a, [\"tagName\"]);\n\n          return Vector.create(\"\".concat(tagName) || 'path', Dom.kebablizeAttrs(Object.assign(Object.assign({}, attrs), other)));\n        }) : [Vector.create(tagName || 'path', Dom.kebablizeAttrs(attrs))]);\n        this.defs.appendChild(pathMarker.node);\n      }\n\n      return markerId;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(id) {\n      var elem = this.svg.getElementById(id);\n\n      if (elem && elem.parentNode) {\n        elem.parentNode.removeChild(elem);\n      }\n    }\n  }, {\n    key: \"cid\",\n    get: function get() {\n      return this.graph.view.cid;\n    }\n  }, {\n    key: \"svg\",\n    get: function get() {\n      return this.view.svg;\n    }\n  }, {\n    key: \"defs\",\n    get: function get() {\n      return this.view.defs;\n    }\n  }]);\n\n  return DefsManager;\n}(Base);","map":null,"metadata":{},"sourceType":"module"}