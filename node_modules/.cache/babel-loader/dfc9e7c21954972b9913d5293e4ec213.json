{"ast":null,"code":"import _classCallCheck from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/shuge/Documents/project/rekit-project/ServiceWebsite/Spine/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Disablable } from '../../common';\nexport var AutoSave = /*#__PURE__*/function (_Disablable) {\n  _inherits(AutoSave, _Disablable);\n\n  function AutoSave(options) {\n    var _this;\n\n    _classCallCheck(this, AutoSave);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AutoSave).call(this));\n    _this.delay = 10;\n    _this.throttle = 2;\n    _this.threshold = 5;\n    _this.changeCount = 0;\n    _this.timestamp = 0;\n    _this.options = Object.assign(Object.assign({}, AutoSave.defaultOptions), options);\n\n    _this.graph.model.on('cell:change:*', _this.onModelChanged, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    return _this;\n  }\n\n  _createClass(AutoSave, [{\n    key: \"onModelChanged\",\n    value: function onModelChanged() {\n      if (this.disabled) {\n        return;\n      }\n\n      var now = new Date().getTime();\n      var dt = (now - this.timestamp) / 1000;\n\n      if (dt > this.delay || this.changeCount >= this.threshold && dt > this.throttle) {\n        this.save();\n        this.reset();\n      } else {\n        this.changeCount += 1;\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      this.trigger('save');\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.changeCount = 0;\n      this.timestamp = new Date().getTime();\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.graph.model.off('cell:change:*', this.onModelChanged, this);\n    }\n  }, {\n    key: \"graph\",\n    get: function get() {\n      return this.options.graph;\n    }\n  }]);\n\n  return AutoSave;\n}(Disablable);\n\n__decorate([Disablable.dispose()], AutoSave.prototype, \"dispose\", null);\n\n(function (AutoSave) {\n  AutoSave.defaultOptions = {\n    delay: 10,\n    throttle: 2,\n    threshold: 5\n  };\n})(AutoSave || (AutoSave = {}));","map":null,"metadata":{},"sourceType":"module"}